syntax = "proto3";

option java_multiple_files = true;
option java_package = "io.nyas.vector";
option java_outer_classname = "VectorProto";

package vector;

service VectorDB {
  rpc InsertVector (InsertVectorRequest) returns (InsertVectorResponse);
  rpc SearchVector (SearchVectorRequest) returns (SearchVectorResponse);
  rpc BuildIndex (BuildIndexRequest) returns (BuildIndexResponse);
}

enum IndexType {
  INDEX_TYPE_UNSPECIFIED = 0;
  INDEX_TYPE_FLAT = 1;   // Brute-force search
  INDEX_TYPE_HNSW = 2;   // Hierarchical navigable small world
  INDEX_TYPE_DISKANN = 3; // Disk-based ANN
}

message InsertVectorRequest {
  string id = 1;
  repeated float vector = 2;
}

message InsertVectorResponse {
  bool success = 1;
}

message SearchVectorRequest {
  repeated float vector = 1;
  uint32 top_k = 2;
}

message SearchVectorResponse {
  repeated string ids = 1;
  repeated float distances = 2;
}

message BuildIndexRequest {
  IndexType index_type = 1;
}

message BuildIndexResponse {
  bool success = 1;
}
